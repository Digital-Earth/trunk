app.service('demoClimate', function (dispatcher,featureWalkThrough) {
    
    function register($scope) {
        var temperatureMap =
 {
            "Type": "Map", "Metadata": { "Name": "New Globe" }, "Expanded": true,
            "Groups": [
                {
                    "Metadata": { "Name": "" },
                    "Items": [
                        { "Metadata": { "Comments": [], "Ratings": { "Likes": 0, "Dislikes": 0 }, "User": { "Id": "c509bb71-192b-4fa9-aa58-58ab58f43473", "Name": "Pyxis" }, "Providers": [{ "Type": "Gallery", "Id": "98852ce8-7498-a534-6fad-15ece18f7826", "Name": "Pyxis" }], "Category": "SDK", "Created": "2015-09-28T06:45:45.507Z", "Updated": "2015-09-28T06:52:10.868Z", "BasedOnVersion": "81d2e158-def5-42e2-874c-307396a5e990", "Visibility": "Public", "Name": "Land surface temperature January 2015", "Description": "", "Tags": ["Land", "Temperature"], "SystemTags": [], "ExternalUrls": [{ "Type": "Image", "Url": "http://www.pyxisinnovation.com/images/pipelines/5f7673c0-219a-48e9-b655-6577694e9a25.png" }] }, "Specification": { "OutputType": "Coverage", "Fields": [{ "Name": "RGB", "FieldType": "Number", "FieldUnit": { "Name": "C" }, "Metadata": { "Name": "Temperature 2015", "Description": "", "SystemTags": ["Favorite"] }, "Starred": true, "OnDashboard": false, "Value": 1.4566929340362549 }] }, "Resource": { "Id": "5f7673c0-219a-48e9-b655-6577694e9a25", "Type": "GeoSource", "Version": "f88efe88-c500-45ba-84ed-4bf8f130b3e9" }, "Style": { "Fill": { "PaletteExpression": "RGB", "Style": "Palette", "Palette": { "Steps": [{ "Value": -25, "Color": "#E5E5E5" }, { "Value": -20, "Color": "#247BFE" }, { "Value": -10, "Color": "#28BAEB" }, { "Value": 0, "Color": "#00C305" }, { "Value": 10, "Color": "#F2FF01" }, { "Value": 20, "Color": "#FFDD20" }, { "Value": 30, "Color": "#FFA801" }, { "Value": 40, "Color": "#FF6003" }, { "Value": 45, "Color": "#FF2B2D" }, { "Value": 50, "Color": "rgba(0,0,0,0.00)" }] }, "Color": null }, "ShowAsElevation": false }, "Active": true, "ShowDetails": true },
                        { "Metadata": { "Comments": [], "Ratings": { "Likes": 0, "Dislikes": 0 }, "User": { "Id": "c509bb71-192b-4fa9-aa58-58ab58f43473", "Name": "Pyxis" }, "Providers": [{ "Type": "Gallery", "Id": "98852ce8-7498-a534-6fad-15ece18f7826", "Name": "Pyxis" }], "Category": "SDK", "Created": "2015-09-28T06:47:14.496Z", "Updated": "2015-09-28T06:51:54.726Z", "BasedOnVersion": "1e955682-32ad-4b6f-b466-dd4a7909b2ab", "Visibility": "Public", "Name": "Land surface temperature January 2050", "Description": "", "Tags": ["Land", "Temperature"], "SystemTags": [], "ExternalUrls": [{ "Type": "Image", "Url": "http://www.pyxisinnovation.com/images/pipelines/e25a985a-7681-4186-8e27-db4a1f3ea29a.png" }] }, "Specification": { "OutputType": "Coverage", "Fields": [{ "Name": "RGB", "FieldType": "Number", "FieldUnit": { "Name": "C" }, "Metadata": { "Name": "Temperature 2050", "Description": "", "SystemTags": ["Favorite"] }, "Starred": true, "OnDashboard": false, "Value": 19.64566993713379 }] }, "Resource": { "Id": "e25a985a-7681-4186-8e27-db4a1f3ea29a", "Type": "GeoSource", "Version": "724cfeff-bbb7-46da-bc05-792374466886" }, "Style": { "Fill": { "PaletteExpression": "RGB", "Style": "Palette", "Palette": { "Steps": [{ "Value": -25, "Color": "#E5E5E5" }, { "Value": -20, "Color": "#247BFE" }, { "Value": -10, "Color": "#28BAEB" }, { "Value": 0, "Color": "#00C305" }, { "Value": 10, "Color": "#F2FF01" }, { "Value": 20, "Color": "#FFDD20" }, { "Value": 30, "Color": "#FFA801" }, { "Value": 40, "Color": "#FF6003" }, { "Value": 45, "Color": "#FF2B2D" }, { "Value": 50, "Color": "rgba(0,0,0,0.00)" }] }, "Color": null }, "ShowAsElevation": false }, "Active": false, "ShowDetails": true },
                        { "Metadata": { "Comments": [], "Ratings": { "Likes": 0, "Dislikes": 0 }, "User": { "Id": "e5d51f7e-32f3-4916-ad53-dfe3faebd369", "Name": "ppeterson" }, "Providers": [{ "Type": "Gallery", "Id": "a157cc15-9271-4485-b089-3e8875bb92d2", "Name": "ppeterson" }], "Category": "Demo", "Created": "2013-11-26T02:23:14Z", "Updated": "2014-08-01T20:54:36.338Z", "BasedOnVersion": "87d4f5cc-1d19-4d55-bd9e-804b17f608ce", "Visibility": "Public", "Name": "World Political Boundaries", "Description": "World Political Boundaries 2000. Administrative boundary files are the intellectual property of ESRI and its licensors and are using herein with permission. Â© 1992-1997 ESRI, GMi. All Rights Reserved.", "Tags": ["Boundaries", "Cultural"], "SystemTags": [], "ExternalUrls": [{ "Type": "Image", "Url": "https://www.pyxisinnovation.com/images/pipelines/7664e383-9d2c-494d-b3ec-5ae708623565.png" }] }, "Specification": { "OutputType": "Feature", "Fields": [{ "Name": "HIT", "FieldType": "String", "FieldUnit": null, "Metadata": { "Comments": null, "Ratings": null, "User": null, "Providers": null, "Category": null, "Created": "0001-01-01T00:00:00", "Updated": "0001-01-01T00:00:00", "BasedOnVersion": null, "Visibility": null, "Name": "HIT", "Description": "", "Tags": null, "SystemTags": ["Favorite"], "ExternalUrls": null }, "ValueTranslation": null, "Starred": true, "OnDashboard": false, "Value": "WYO-OO" }, { "Name": "COUNT", "FieldType": "Number", "FieldUnit": null, "Metadata": { "Comments": null, "Ratings": null, "User": null, "Providers": null, "Category": null, "Created": "0001-01-01T00:00:00", "Updated": "0001-01-01T00:00:00", "BasedOnVersion": null, "Visibility": null, "Name": "COUNT", "Description": "", "Tags": null, "SystemTags": ["Favorite"], "ExternalUrls": null }, "ValueTranslation": null, "Starred": true, "OnDashboard": false, "Value": 1 }, { "Name": "ID", "FieldType": "Number", "FieldUnit": null, "Metadata": { "Comments": null, "Ratings": null, "User": null, "Providers": null, "Category": null, "Created": "0001-01-01T00:00:00", "Updated": "0001-01-01T00:00:00", "BasedOnVersion": null, "Visibility": null, "Name": "ID", "Description": "", "Tags": null, "SystemTags": ["Favorite"], "ExternalUrls": null }, "ValueTranslation": null, "Starred": true, "OnDashboard": false, "Value": 577 }, { "Name": "ISO_CODE", "FieldType": "String", "FieldUnit": null, "Metadata": { "Comments": null, "Ratings": null, "User": null, "Providers": null, "Category": null, "Created": "0001-01-01T00:00:00", "Updated": "0001-01-01T00:00:00", "BasedOnVersion": null, "Visibility": null, "Name": "ISO_CODE", "Description": "", "Tags": null, "SystemTags": ["Favorite"], "ExternalUrls": null }, "ValueTranslation": null, "Starred": true, "OnDashboard": false, "Value": "US" }, { "Name": "LEVEL_4_NA", "FieldType": "String", "FieldUnit": null, "Metadata": { "Comments": null, "Ratings": null, "User": null, "Providers": null, "Category": null, "Created": "0001-01-01T00:00:00", "Updated": "0001-01-01T00:00:00", "BasedOnVersion": null, "Visibility": null, "Name": "Name", "Description": "", "Tags": null, "SystemTags": ["Favorite"], "ExternalUrls": null }, "ValueTranslation": null, "Starred": true, "OnDashboard": false, "Value": "Wyoming" }, { "Name": "LEVEL_4_CO", "FieldType": "String", "FieldUnit": null, "Metadata": { "Comments": null, "Ratings": null, "User": null, "Providers": null, "Category": null, "Created": "0001-01-01T00:00:00", "Updated": "0001-01-01T00:00:00", "BasedOnVersion": null, "Visibility": null, "Name": "LEVEL_4_CO", "Description": "", "Tags": null, "SystemTags": [], "ExternalUrls": null }, "ValueTranslation": null, "Starred": false, "OnDashboard": false, "Value": "OO" }, { "Name": "LEVEL_3_CO", "FieldType": "String", "FieldUnit": null, "Metadata": { "Comments": null, "Ratings": null, "User": null, "Providers": null, "Category": null, "Created": "0001-01-01T00:00:00", "Updated": "0001-01-01T00:00:00", "BasedOnVersion": null, "Visibility": null, "Name": "LEVEL_3_CO", "Description": "", "Tags": null, "SystemTags": [], "ExternalUrls": null }, "ValueTranslation": null, "Starred": false, "OnDashboard": false, "Value": "WYO" }, { "Name": "LEVEL_2_RE", "FieldType": "Number", "FieldUnit": null, "Metadata": { "Comments": null, "Ratings": null, "User": null, "Providers": null, "Category": null, "Created": "0001-01-01T00:00:00", "Updated": "0001-01-01T00:00:00", "BasedOnVersion": null, "Visibility": null, "Name": "LEVEL_2_RE", "Description": "", "Tags": null, "SystemTags": [], "ExternalUrls": null }, "ValueTranslation": null, "Starred": false, "OnDashboard": false, "Value": 73 }, { "Name": "LEVEL_1_CO", "FieldType": "Number", "FieldUnit": null, "Metadata": { "Comments": null, "Ratings": null, "User": null, "Providers": null, "Category": null, "Created": "0001-01-01T00:00:00", "Updated": "0001-01-01T00:00:00", "BasedOnVersion": null, "Visibility": null, "Name": "LEVEL_1_CO", "Description": "", "Tags": null, "SystemTags": [], "ExternalUrls": null }, "ValueTranslation": null, "Starred": false, "OnDashboard": false, "Value": 7 }, { "Name": "ID 2", "FieldType": "Number", "FieldUnit": null, "Metadata": { "Comments": null, "Ratings": null, "User": null, "Providers": null, "Category": null, "Created": "0001-01-01T00:00:00", "Updated": "0001-01-01T00:00:00", "BasedOnVersion": null, "Visibility": null, "Name": "ID 2", "Description": "", "Tags": null, "SystemTags": [], "ExternalUrls": null }, "ValueTranslation": null, "Starred": false, "OnDashboard": false, "Value": 360 }, { "Name": "LEVEL_NAME", "FieldType": "String", "FieldUnit": null, "Metadata": { "Comments": null, "Ratings": null, "User": null, "Providers": null, "Category": null, "Created": "0001-01-01T00:00:00", "Updated": "0001-01-01T00:00:00", "BasedOnVersion": null, "Visibility": null, "Name": "LEVEL_NAME", "Description": "", "Tags": null, "SystemTags": [], "ExternalUrls": null }, "ValueTranslation": null, "Starred": false, "OnDashboard": false, "Value": "Wyoming" }, { "Name": "REGION_NAM", "FieldType": "String", "FieldUnit": null, "Metadata": { "Comments": null, "Ratings": null, "User": null, "Providers": null, "Category": null, "Created": "0001-01-01T00:00:00", "Updated": "0001-01-01T00:00:00", "BasedOnVersion": null, "Visibility": null, "Name": "REGION_NAM", "Description": "", "Tags": null, "SystemTags": [], "ExternalUrls": null }, "ValueTranslation": null, "Starred": false, "OnDashboard": false, "Value": "Northwestern U.S.A." }, { "Name": "CONTINENT", "FieldType": "String", "FieldUnit": null, "Metadata": { "Comments": null, "Ratings": null, "User": null, "Providers": null, "Category": null, "Created": "0001-01-01T00:00:00", "Updated": "0001-01-01T00:00:00", "BasedOnVersion": null, "Visibility": null, "Name": "CONTINENT", "Description": "", "Tags": null, "SystemTags": [], "ExternalUrls": null }, "ValueTranslation": null, "Starred": false, "OnDashboard": false, "Value": "NORTHERN AMERICA" }] }, "Resource": { "Id": "7664e383-9d2c-494d-b3ec-5ae708623565", "Type": "GeoSource", "Version": "ff42f986-bb66-4d40-a7f8-15f9eaeae387" }, "Style": { "Line": { "Style": "SolidColor", "Color": "#000000" } }, "Active": true, "ShowDetails": true }
                    ]
                }
            ],
            "Dashboards": [{ "Widgets": [] }],
            "EmbeddedResources": [],
            "Camera": { "Tilt": 0.000006273929358258101, "Heading": 359.720619244193, "Latitude": 39.95444137741241, "Longitude": -97.92516174279886, "Altitude": 0, "Range": 8545881.624487549 }
        };
        
        
        var steps = [
            featureWalkThrough.makeWalkThroughStep({ left: 50, top: 50 }, "Welcome to WorldView. In this demo you will see how Earth is changing. Let's get started!", function () {
                $scope.setCurrentMap(undefined);
                $scope.gotoCamera({ "Tilt": 0.0000179292465816161, "Heading": 354.6243376625605, "Latitude": 30.556130414958865, "Longitude": 100.53729064170695, "Altitude": 0, "Range": 10053979.613455815 });
            }),
            featureWalkThrough.makeWalkThroughStep({ left: 50, top: 50 }, "This is Earth as we know it now", function () {
                var map = { "Type": "Map", "Metadata": { "Name": "New Globe" }, "Expanded": true, "Groups": [{ "Metadata": { "Name": "" }, "Items": [{ "Metadata": { "Comments": [], "Ratings": { "Likes": 0, "Dislikes": 0 }, "User": { "Id": "23119ff4-b1c8-47a9-9817-65deb2d02a4e", "Name": "JoJonesMaps" }, "Providers": [{ "Type": "Gallery", "Id": "5b434fa1-b578-4eb2-81c5-a823377aa931", "Name": "JoJonesMaps" }], "Category": "SDK", "Created": "2015-09-27T02:50:11.578Z", "Updated": "2015-09-27T02:50:11.578Z", "BasedOnVersion": "20571fad-20f4-4869-b5fe-ebca54cbd890", "Visibility": "Public", "Name": "Land Surface, Ocean Colour, Sea Ice, and Clouds", "Description": "This spectacular “blue marble” image is the most detailed true-color image of the entire Earth to date. Using a collection of satellite-based observations, scientists and visualizers stitched together months of observations of the land surface, oceans, sea ice, and clouds into a seamless, true-color mosaic of every square kilometer (.386 square mile) of our planet. \n\nCredit: NASA Goddard Space Flight Center Image by Reto Stöckli (land surface, shallow water, clouds). Enhancements by Robert Simmon (ocean color, compositing, 3D globes, animation). Data and technical support: MODIS Land Group; MODIS Science Data Support Team; MODIS Atmosphere Group; MODIS Ocean Group Additional data: USGS EROS Data Center (topography); USGS Terrestrial Remote Sensing Flagstaff Field Center (Antarctica); Defense Meteorological Satellite Program (city lights).", "Tags": ["Clouds", "Land", "Ice", "Earth", "Ocean"], "SystemTags": [], "ExternalUrls": [{ "Type": "Image", "Url": "http://www.pyxisinnovation.com/images/pipelines/ced24668-a781-4abe-b86b-a7a98c43c165.png" }] }, "Specification": { "OutputType": "Coverage", "Fields": [{ "Name": "RGB", "FieldType": "Color", "Metadata": { "Name": "RGB", "Description": "", "SystemTags": [] } }] }, "Resource": { "Id": "ced24668-a781-4abe-b86b-a7a98c43c165", "Type": "GeoSource", "Version": "365046f3-1fee-4e65-bb30-13c9902279fd" }, "Style": { "ShowAsElevation": false }, "Active": true, "ShowDetails": true }, { "Metadata": { "Comments": [], "Ratings": { "Likes": 0, "Dislikes": 0 }, "User": { "Id": "c509bb71-192b-4fa9-aa58-58ab58f43473", "Name": "Pyxis" }, "Providers": [{ "Type": "Gallery", "Id": "32f9cd5d-6ef6-4601-b367-109d8d288557", "Name": "Microsoft Bing Maps" }], "Category": "Demo", "Created": "2014-05-05T21:21:34Z", "Updated": "2015-01-11T00:09:40.058Z", "BasedOnVersion": "1d6a3b01-50ef-4d80-906c-9e1524d77c32", "Visibility": "Public", "Name": "Global Elevation (GTOPO30)", "Description": "GTOPO30 is a global digital elevation model (DEM) with a horizontal grid spacing of 30 arc seconds (approximately 1 kilometer). GTOPO30 was derived from several raster and vector sources of topographic information.\r\n\r\nGTOPO30, completed in late 1996, was developed over a three year period through a collaborative effort led by staff at the U.S. Geological Survey's Center for Earth Resources Observation and Science (EROS). The following organizations participated by contributing funding or source data:  the National Aeronautics and Space Administration (NASA), the United Nations Environment Programme/Global Resource Information Database (UNEP/GRID), the U.S. Agency for International Development (USAID), the Instituto Nacional de Estadistica Geografica e Informatica (INEGI) of Mexico, the Geographical Survey Institute (GSI) of Japan, Manaaki Whenua Landcare Research of New Zealand, and the Scientific Committee on Antarctic Research (SCAR).\r\n\r\nsource: https://lta.cr.usgs.gov/GTOPO30", "Tags": ["Global", "Elevation"], "SystemTags": [], "ExternalUrls": [{ "Type": "Image", "Url": "https://www.pyxisinnovation.com/images/pipelines/8be6a2ec-5110-49cf-a295-1008f8e9a21b.jpg" }] }, "Specification": { "OutputType": "Coverage", "Fields": [{ "Name": "RGB", "FieldType": "Number", "FieldUnit": { "Name": "m" }, "Metadata": { "Name": "Elevation", "Description": "", "SystemTags": [] } }] }, "Resource": { "Id": "8be6a2ec-5110-49cf-a295-1008f8e9a21b", "Type": "GeoSource", "Version": "0329caed-c92e-49c7-b7ce-d0b81af25d97" }, "Style": { "Fill": { "PaletteExpression": "RGB", "Style": "Palette", "Palette": { "Steps": [{ "Value": 0, "Color": "#000000" }, { "Value": 9000, "Color": "#FFFFFF" }] }, "Color": null }, "ShowAsElevation": true }, "Active": true, "ShowDetails": true, "Legend": { "Expanded": true } }] }], "Dashboards": [{ "Widgets": [] }], "EmbeddedResources": [] };
                $scope.setCurrentMap(map);
                $scope.gotoCamera({ "Tilt": 0.00005954420871034927, "Heading": 347.75218911007534, "Latitude": 36.40414238536614, "Longitude": -29.392922662412214, "Altitude": 0, "Range": 11828209.224191863 });
            }),
            featureWalkThrough.makeWalkThroughStep({ left: 50, top: 70 }, "As seasons change we learn about Earth and its systems. Small changes are affecting the rhythm of life.  Let’s see how these changes might impact you?", function () {
                var map = angular.copy(temperatureMap);
                map.Groups[0].Items[0].Active = true;
                map.Groups[0].Items[1].Active = false;
                $scope.setCurrentMap(map);
                $scope.gotoCamera(map.Camera);
            }),
            featureWalkThrough.makeWalkThroughStep({ left: 50, top: 70 }, "This is average minimum temperature around Earth this last January. Right click to open the properties window to see the average minimum temperatures", function () {
            }),
            featureWalkThrough.makeWalkThroughStep({ left: 50, top: 70 }, "This is what will be in 2050, right click on the map to see what are the temperature will be in few years from now", function () {
                var map = angular.copy(temperatureMap);
                map.Groups[0].Items[0].Active = false;
                map.Groups[0].Items[1].Active = true;
                $scope.setCurrentMap(map);
            }),
            featureWalkThrough.makeWalkThroughStep({ left: 80, top: 70 }, "This is where we can grow apples in Alberta now", function () {
                var map = angular.copy(temperatureMap);
                map.Groups[0].Items[0].Active = true;
                map.Groups[0].Items[1].Active = false;
                $scope.setCurrentMap(map);
                var selection = { "Geometry": { "type": "Boolean", "operations": [{ "operation": "Disjunction", "geometry": { "createdByTool": "magic-wand", "type": "FeatureRef", "resource": { "Type": "GeoSource", "Id": "7664e383-9d2c-494d-b3ec-5ae708623565", "Version": "ff42f986-bb66-4d40-a7f8-15f9eaeae387" }, "id": "0" } }, { "operation": "Intersection", "geometry": { "type": "Condition", "resource": { "Id": "5f7673c0-219a-48e9-b655-6577694e9a25", "Type": "GeoSource", "Version": "f88efe88-c500-45ba-84ed-4bf8f130b3e9" }, "property": "RGB", "range": { "Min": -5, "Max": 10 } } }] }, "Style": { "Fill": { "Style": "SolidColor", "Color": "rgba(255,43,45,0.3)" }, "Line": { "Style": "SolidColor", "Color": "#FF2B2D" } } };
                dispatcher.actions.changeSelection.invoke({ 'selection': selection });
                $scope.gotoCamera({ "Tilt": 45.00000256023421, "Heading": 0.46419867689893834, "Latitude": 54.757740695279466, "Longitude": -113.94930544812733, "Altitude": 0, "Range": 1682465.1445486727 });
            }),
            featureWalkThrough.makeWalkThroughStep({ left: 70, top: 40 }, "This is where we can grow apples in Alberta in 2050", function () {
                var map = angular.copy(temperatureMap);
                map.Groups[0].Items[0].Active = false;
                map.Groups[0].Items[1].Active = true;
                $scope.setCurrentMap(map);
                var selection = { "Geometry": { "type": "Boolean", "operations": [{ "operation": "Disjunction", "geometry": { "createdByTool": "magic-wand", "type": "FeatureRef", "resource": { "Type": "GeoSource", "Id": "7664e383-9d2c-494d-b3ec-5ae708623565", "Version": "ff42f986-bb66-4d40-a7f8-15f9eaeae387" }, "id": "0" } }, { "operation": "Intersection", "geometry": { "type": "Condition", "resource": { "Id": "e25a985a-7681-4186-8e27-db4a1f3ea29a", "Type": "GeoSource", "Version": "724cfeff-bbb7-46da-bc05-792374466886" }, "property": "RGB", "range": { "Min": -5, "Max": 10 } } }] }, "Style": { "Fill": { "Style": "SolidColor", "Color": "rgba(255,43,45,0.3)" }, "Line": { "Style": "SolidColor", "Color": "#FF2B2D" } } };
                dispatcher.actions.changeSelection.invoke({ 'selection': selection });
            }),
            featureWalkThrough.makeWalkThroughStep({ left: 50, top: 50 }, "This is the power of Digital Earth, Expand your WorldView with PYXIS.", function () {
                $scope.gotoCamera({ "Tilt": 0.0000179292465816161, "Heading": 354.6243376625605, "Latitude": 50.556130414958865, "Longitude": 24.53729064170695, "Altitude": 0, "Range": 10053979.613455815 });
            })
        ];
        
        $scope.walkThrough.start(steps);
    };
    
    return {
        register: register
    };
});