/*
worldViewStudioController aimed to be the skin for web demos (not fully working studio)
*/
app.controller("worldViewStudioController", function (
    $scope, $pyx, $pyxconfig, worldViewStudioBootstrap, $interval,

    //demos
    featureWalkThrough,
    featureInspectorTools,
    demoClimate,
    demoLoop

    ) {

    worldViewStudioBootstrap($scope, { mode: 'demo' });
    
    featureInspectorTools.register($scope);

    $scope.timeLine = [];   

    $scope.timeLine.push({
        duration: 10,
        start: 0,
        map: { "Type": "Map", "Metadata": { "Name": "New Map", "Theme": { "name": "Light Theme", "specular": 0.4, "shininess": 16, "diffuseStrength": 2, "lightingEnable": 0, "dataMin": 0, "dataMax": 9000, "backgroundColor": "#f0f0f0", "environmentMultiplier": 1.5839464882943144, "heightMultiplier": 1, "normalmapStrength": 1, "landOnly": 1, "gammaValue": 2.946397660560254, "colorBoost": "#000000", "colorTint": "#898989", "tiltshiftValue": 0, "tiltshiftRes": 0.45, "rangeMax": 19260263, "rangeMin": 24594, "latMax": -1, "latMin": -1, "lonMax": -1, "lonMin": -1, "fogColor": "#dcdcdc", "fogIntensity": 0.5, "fogHeightOffset": -200, "fogBlendCoef": 3.2, "fogCameraDistCoef": 5.6, "color0": "#525252", "color1": "#2f2f2f", "color2": "#aa3232", "color3": "#ff9d11", "color4": "#ff4b00", "color5": "#dc8320", "lightIntensity": 0, "roughMatcap": "assets/images/textures/matcaps/globe_matcap_silver.png", "glossMatcap": "assets/images/textures/matcaps/globe_matcap_silver_bright.png", "noiseMap": "assets/images/textures/noisemap512.jpg", "globeBackground": "#898989", "noiseMultiplier": 0, "basemapRoughness": 0.6100334448160535, "basemapLightingMultiplier": 2, "surfaceRoughness": 1, "surfaceLightingMultiplier": 0, "layer0Alpha": 1, "layer0Tint": "#5f5f5f", "layer1Alpha": 0.7002688573219419, "layer1Tint": "#ffffff", "layer2Alpha": 1, "layer2Tint": "#777777", "layer3Alpha": 1, "layer3Tint": "#777777", "layer4Alpha": 1, "layer4Tint": "#777777", "layer5Alpha": 1, "layer5Tint": "#777777", "layer6Alpha": 1, "layer6Tint": "#777777", "layer7Alpha": 1, "layer7Tint": "#777777", "layer8Alpha": 1, "layer8Tint": "#777777", "layer9Alpha": 1, "layer9Tint": "#777777", "iconAlpha": 1, "iconBorderColor": "#000000", "defaultRenderLayers": [{ "geoSource": { "Id": "8be6a2ec-5110-49cf-a295-1008f8e9a21b", "Specification": { "OutputType": "Coverage" } }, "style": { "ShowAsElevation": true, "Fill": { "Style": "Palette", "PaletteExpression": "RGB", "Palette": { "Steps": [{ "Value": -200, "Color": "rgba(0,0,0,0.0)" }, { "Value": 0, "Color": "#000000" }, { "Value": 3341, "Color": "#111111" }, { "Value": 5052, "Color": "#111111" }] } } } }], "defaultMapGroupObject": { "Metadata": { "Name": "Theme Basemap" }, "Items": [{ "Metadata": { "Comments": [], "Ratings": { "Likes": 0, "Dislikes": 0 }, "User": { "Id": "c509bb71-192b-4fa9-aa58-58ab58f43473", "Name": "Pyxis" }, "Providers": [{ "Type": "Gallery", "Id": "32f9cd5d-6ef6-4601-b367-109d8d288557", "Name": "Microsoft Bing Maps" }], "Category": "Demo", "Created": "2014-05-05T21:21:34Z", "Updated": "2015-01-11T00:09:40.058Z", "BasedOnVersion": "1d6a3b01-50ef-4d80-906c-9e1524d77c32", "Visibility": "Public", "Name": "Global Elevation (GTOPO30)", "Description": "GTOPO30..", "Tags": ["Global", "Elevation"], "SystemTags": [], "ExternalUrls": [{ "Type": "Image", "Url": "https://www.pyxisinnovation.com/images/pipelines/8be6a2ec-5110-49cf-a295-1008f8e9a21b.jpg" }] }, "Specification": { "OutputType": "Coverage", "Fields": [{ "Name": "RGB", "FieldType": "Number", "FieldUnit": { "Name": "m" }, "Metadata": { "Name": "Elevation", "Description": "", "SystemTags": ["Favorite"] }, "Starred": true, "OnDashboard": false, "Value": 1848 }] }, "Resource": { "Id": "8be6a2ec-5110-49cf-a295-1008f8e9a21b", "Type": "GeoSource", "Version": "0329caed-c92e-49c7-b7ce-d0b81af25d97" }, "Style": { "Fill": { "PaletteExpression": "RGB", "Style": "Palette", "Palette": { "Steps": [{ "Value": -200, "Color": "rgba(0,0,0,0.0)" }, { "Value": 0, "Color": "#000000" }, { "Value": 3341.39, "Color": "#111111" }, { "Value": 5052.27, "Color": "#111111" }] }, "Color": null }, "ShowAsElevation": true }, "Active": true, "ShowDetails": true, "Legend": { "Expanded": true } }] } } }, "Expanded": true, "Groups": [{ "Metadata": { "Name": "" }, "Items": [{ "Metadata": { "Comments": [], "Ratings": { "Likes": 0, "Dislikes": 0 }, "User": { "Id": "c509bb71-192b-4fa9-aa58-58ab58f43473", "Name": "Pyxis" }, "Providers": [{ "Type": "Gallery", "Id": "32f9cd5d-6ef6-4601-b367-109d8d288557", "Name": "Microsoft Bing Maps" }], "Category": "Demo", "Created": "2014-05-05T21:21:34Z", "Updated": "2015-01-11T00:09:40.058Z", "BasedOnVersion": "1d6a3b01-50ef-4d80-906c-9e1524d77c32", "Visibility": "Public", "Name": "Global Elevation (GTOPO30)", "Description": "GTOPO30 is a global digital elevation model (DEM) with a horizontal grid spacing of 30 arc seconds (approximately 1 kilometer). GTOPO30 was derived from several raster and vector sources of topographic information.\r\n\r\nGTOPO30, completed in late 1996, was developed over a three year period through a collaborative effort led by staff at the U.S. Geological Survey's Center for Earth Resources Observation and Science (EROS). The following organizations participated by contributing funding or source data:  the National Aeronautics and Space Administration (NASA), the United Nations Environment Programme/Global Resource Information Database (UNEP/GRID), the U.S. Agency for International Development (USAID), the Instituto Nacional de Estadistica Geografica e Informatica (INEGI) of Mexico, the Geographical Survey Institute (GSI) of Japan, Manaaki Whenua Landcare Research of New Zealand, and the Scientific Committee on Antarctic Research (SCAR).\r\n\r\nsource: https://lta.cr.usgs.gov/GTOPO30", "Tags": ["Global", "Elevation"], "SystemTags": [], "ExternalUrls": [{ "Type": "Image", "Url": "https://www.pyxisinnovation.com/images/pipelines/8be6a2ec-5110-49cf-a295-1008f8e9a21b.jpg" }] }, "Specification": { "OutputType": "Coverage", "Fields": [{ "Name": "RGB", "FieldType": "Number", "FieldUnit": { "Name": "m" }, "Metadata": { "Name": "Elevation", "Description": "", "SystemTags": [] } }] }, "Resource": { "Id": "8be6a2ec-5110-49cf-a295-1008f8e9a21b", "Type": "GeoSource", "Version": "0329caed-c92e-49c7-b7ce-d0b81af25d97" }, "Style": { "Fill": { "PaletteExpression": "RGB", "Style": "Palette", "Palette": { "Steps": [{ "Value": -200, "Color": "rgba(0,0,0,0.0)" }, { "Value": -0.38, "Color": "#808080" }, { "Value": 9000, "Color": "#808080" }] }, "Color": null }, "ShowAsElevation": true }, "Active": true, "ShowDetails": true, "Legend": { "Expanded": true } }] }], "Dashboards": [{ "Widgets": [] }], "EmbeddedResources": [] },
        camera: { "Tilt": 0.00005708803308834831, "Heading": 7.444434175076949, "Latitude": 24.325189786472162, "Longitude": -63.97448440588935, "Altitude": 0, "Range": 8600575.872065304 },
        message: { title: "Welcome", content: "This is the future. " }
    });
    $scope.timeLine.push({
        duration: 10,
        start: 10,
        name: "Purple",
        color: "#808",
        map: { "Type": "Map", "Metadata": { "Name": "New Map", "Theme": { "name": "Light Theme", "specular": 0.4, "shininess": 16, "diffuseStrength": 2, "lightingEnable": 0, "dataMin": 0, "dataMax": 9000, "backgroundColor": "#f0f0f0", "environmentMultiplier": 1.3316588106450042, "heightMultiplier": 1, "normalmapStrength": 1, "landOnly": 1, "gammaValue": 2.3822154383000673, "colorBoost": "#000000", "colorTint": "#828282", "tiltshiftValue": 0, "tiltshiftRes": 0.45, "rangeMax": 19260263, "rangeMin": 24594, "latMax": -1, "latMin": -1, "lonMax": -1, "lonMin": -1, "fogColor": "#dcdcdc", "fogIntensity": 0.5, "fogHeightOffset": -200, "fogBlendCoef": 3.2, "fogCameraDistCoef": 5.6, "color0": "#525252", "color1": "#2f2f2f", "color2": "#aa3232", "color3": "#ff9d11", "color4": "#ff4b00", "color5": "#dc8320", "lightIntensity": 0, "roughMatcap": "assets/images/textures/matcaps/globe_matcap_black_white_smooth.png", "glossMatcap": "assets/images/textures/matcaps/globe_matcap_black_white_smooth.png ", "noiseMap": "assets/images/textures/noisemap512.jpg", "globeBackground": "#ffffff", "noiseMultiplier": 0.2, "basemapRoughness": 1, "basemapLightingMultiplier": 0, "surfaceRoughness": 1, "surfaceLightingMultiplier": 1, "layer0Alpha": 0.5969505013236226, "layer0Tint": "#f0f0f0", "layer1Alpha": 0.45919269332586354, "layer1Tint": "#ffffff", "layer2Alpha": 1, "layer2Tint": "#777777", "layer3Alpha": 1, "layer3Tint": "#777777", "layer4Alpha": 1, "layer4Tint": "#777777", "layer5Alpha": 1, "layer5Tint": "#777777", "layer6Alpha": 1, "layer6Tint": "#777777", "layer7Alpha": 1, "layer7Tint": "#777777", "layer8Alpha": 1, "layer8Tint": "#777777", "layer9Alpha": 1, "layer9Tint": "#777777", "iconAlpha": 1, "iconBorderColor": "#000000", "defaultRenderLayers": [{ "geoSource": { "Id": "8be6a2ec-5110-49cf-a295-1008f8e9a21b", "Specification": { "OutputType": "Coverage" } }, "style": { "ShowAsElevation": true, "Fill": { "Style": "Palette", "PaletteExpression": "RGB", "Palette": { "Steps": [{ "Value": -200, "Color": "rgba(0,0,0,0.0)" }, { "Value": 0, "Color": "#000000" }, { "Value": 3341, "Color": "#111111" }, { "Value": 5052, "Color": "#111111" }] } } } }], "defaultMapGroupObject": { "Metadata": { "Name": "Theme Basemap" }, "Items": [{ "Metadata": { "Comments": [], "Ratings": { "Likes": 0, "Dislikes": 0 }, "User": { "Id": "c509bb71-192b-4fa9-aa58-58ab58f43473", "Name": "Pyxis" }, "Providers": [{ "Type": "Gallery", "Id": "32f9cd5d-6ef6-4601-b367-109d8d288557", "Name": "Microsoft Bing Maps" }], "Category": "Demo", "Created": "2014-05-05T21:21:34Z", "Updated": "2015-01-11T00:09:40.058Z", "BasedOnVersion": "1d6a3b01-50ef-4d80-906c-9e1524d77c32", "Visibility": "Public", "Name": "Global Elevation (GTOPO30)", "Description": "GTOPO30..", "Tags": ["Global", "Elevation"], "SystemTags": [], "ExternalUrls": [{ "Type": "Image", "Url": "https://www.pyxisinnovation.com/images/pipelines/8be6a2ec-5110-49cf-a295-1008f8e9a21b.jpg" }] }, "Specification": { "OutputType": "Coverage", "Fields": [{ "Name": "RGB", "FieldType": "Number", "FieldUnit": { "Name": "m" }, "Metadata": { "Name": "Elevation", "Description": "", "SystemTags": ["Favorite"] }, "Starred": true, "OnDashboard": false, "Value": 1848 }] }, "Resource": { "Id": "8be6a2ec-5110-49cf-a295-1008f8e9a21b", "Type": "GeoSource", "Version": "0329caed-c92e-49c7-b7ce-d0b81af25d97" }, "Style": { "Fill": { "PaletteExpression": "RGB", "Style": "Palette", "Palette": { "Steps": [{ "Value": -200, "Color": "rgba(0,0,0,0.0)" }, { "Value": 0, "Color": "#000000" }, { "Value": 3341.39, "Color": "#111111" }, { "Value": 5052.27, "Color": "#111111" }] }, "Color": null }, "ShowAsElevation": true }, "Active": true, "ShowDetails": true, "Legend": { "Expanded": true } }] } } }, "Expanded": true, "Groups": [{ "Metadata": { "Name": "" }, "Items": [{ "Metadata": { "Comments": [], "Ratings": { "Likes": 0, "Dislikes": 0 }, "User": { "Id": "c509bb71-192b-4fa9-aa58-58ab58f43473", "Name": "Pyxis" }, "Providers": [{ "Type": "Gallery", "Id": "32f9cd5d-6ef6-4601-b367-109d8d288557", "Name": "Microsoft Bing Maps" }], "Category": "Demo", "Created": "2014-05-05T21:21:34Z", "Updated": "2015-01-11T00:09:40.058Z", "BasedOnVersion": "1d6a3b01-50ef-4d80-906c-9e1524d77c32", "Visibility": "Public", "Name": "Global Elevation (GTOPO30)", "Description": "GTOPO30 is a global digital elevation model (DEM) with a horizontal grid spacing of 30 arc seconds (approximately 1 kilometer). GTOPO30 was derived from several raster and vector sources of topographic information.\r\n\r\nGTOPO30, completed in late 1996, was developed over a three year period through a collaborative effort led by staff at the U.S. Geological Survey's Center for Earth Resources Observation and Science (EROS). The following organizations participated by contributing funding or source data:  the National Aeronautics and Space Administration (NASA), the United Nations Environment Programme/Global Resource Information Database (UNEP/GRID), the U.S. Agency for International Development (USAID), the Instituto Nacional de Estadistica Geografica e Informatica (INEGI) of Mexico, the Geographical Survey Institute (GSI) of Japan, Manaaki Whenua Landcare Research of New Zealand, and the Scientific Committee on Antarctic Research (SCAR).\r\n\r\nsource: https://lta.cr.usgs.gov/GTOPO30", "Tags": ["Global", "Elevation"], "SystemTags": [], "ExternalUrls": [{ "Type": "Image", "Url": "https://www.pyxisinnovation.com/images/pipelines/8be6a2ec-5110-49cf-a295-1008f8e9a21b.jpg" }] }, "Specification": { "OutputType": "Coverage", "Fields": [{ "Name": "RGB", "FieldType": "Number", "FieldUnit": { "Name": "m" }, "Metadata": { "Name": "Elevation", "Description": "", "SystemTags": [] } }] }, "Resource": { "Id": "8be6a2ec-5110-49cf-a295-1008f8e9a21b", "Type": "GeoSource", "Version": "0329caed-c92e-49c7-b7ce-d0b81af25d97" }, "Style": { "Fill": { "PaletteExpression": "RGB", "Style": "Palette", "Palette": { "Steps": [{ "Value": -200, "Color": "rgba(0,0,0,0.0)" }, { "Value": -69.09, "Color": "#9126FF" }, { "Value": 1616.36, "Color": "#247BFE" }, { "Value": 3500, "Color": "#A6E1FF" }, { "Value": 4705.82, "Color": "#33E0FE" }, { "Value": 7000, "Color": "#00C305" }] }, "Color": null }, "ShowAsElevation": true }, "Active": true, "ShowDetails": true, "Legend": { "Expanded": true } }, { "Metadata": { "Comments": [], "Ratings": { "Likes": 0, "Dislikes": 0 }, "User": { "Id": "e5d51f7e-32f3-4916-ad53-dfe3faebd369", "Name": "ppeterson" }, "Providers": [{ "Type": "Gallery", "Id": "32f9cd5d-6ef6-4601-b367-109d8d288557", "Name": "Microsoft Bing Maps" }], "Category": "Demo", "Created": "2014-05-06T05:26:30.561Z", "Updated": "2014-07-03T22:04:54.894Z", "BasedOnVersion": "5f75efbb-0386-4362-8cbf-10e90cee9950", "Visibility": "Public", "Name": "Global Base Imagery - Terra Pixel", "Description": "(C) 2013 Microsoft Digital Globe - for non commercial demonstration only", "Tags": ["Imagery", "WebService"], "SystemTags": ["WebService"], "ExternalUrls": [{ "Type": "Image", "Url": "https://www.pyxisinnovation.com/images/pipelines/ac8436e7-e492-4bed-ba17-e2007f6d1099.jpg" }] }, "Specification": { "OutputType": "Coverage", "Fields": [{ "Name": "RGB", "FieldType": "Color", "FieldUnit": null, "Metadata": { "Comments": null, "Ratings": null, "User": null, "Providers": null, "Category": null, "Created": "0001-01-01T00:00:00", "Updated": "0001-01-01T00:00:00", "BasedOnVersion": null, "Visibility": null, "Name": "RGB", "Description": "", "Tags": null, "SystemTags": null, "ExternalUrls": null }, "ValueTranslation": null }] }, "Resource": { "Id": "ac8436e7-e492-4bed-ba17-e2007f6d1099", "Type": "GeoSource", "Version": "46958385-0c92-4c71-b708-1493be991900" }, "Style": { "ShowAsElevation": false }, "Active": true, "ShowDetails": true }] }], "Dashboards": [{ "Widgets": [] }], "EmbeddedResources": [] },
        camera: { "Tilt": 0.00008232166783272987, "Heading": 3.2274335143307478, "Latitude": -4.8492399062998865, "Longitude": -66.38478511135592, "Altitude": 0, "Range": 16648243.617421042 },
        message: { title: "DGGS", content: "The ability to integrate any geospatial information on everywhere on the globe. " }
    });
    $scope.timeLine.push({
        duration: 5,
        start: 20,
        map: { "Type": "Map", "Metadata": { "Name": "New Map" }, "Expanded": true, "Groups": [{ "Metadata": { "Name": "" }, "Items": [{ "Metadata": { "Comments": [], "Ratings": { "Likes": 0, "Dislikes": 0 }, "User": { "Id": "23119ff4-b1c8-47a9-9817-65deb2d02a4e", "Name": "JoJonesMaps" }, "Providers": [{ "Type": "Gallery", "Id": "5b434fa1-b578-4eb2-81c5-a823377aa931", "Name": "JoJonesMaps" }], "Category": "SDK", "Created": "2015-09-27T02:50:11.578Z", "Updated": "2015-09-27T02:50:11.578Z", "BasedOnVersion": "20571fad-20f4-4869-b5fe-ebca54cbd890", "Visibility": "Public", "Name": "Land Surface, Ocean Colour, Sea Ice, and Clouds", "Description": "This spectacular “blue marble” image is the most detailed true-color image of the entire Earth to date. Using a collection of satellite-based observations, scientists and visualizers stitched together months of observations of the land surface, oceans, sea ice, and clouds into a seamless, true-color mosaic of every square kilometer (.386 square mile) of our planet. \n\nCredit: NASA Goddard Space Flight Center Image by Reto Stöckli (land surface, shallow water, clouds). Enhancements by Robert Simmon (ocean color, compositing, 3D globes, animation). Data and technical support: MODIS Land Group; MODIS Science Data Support Team; MODIS Atmosphere Group; MODIS Ocean Group Additional data: USGS EROS Data Center (topography); USGS Terrestrial Remote Sensing Flagstaff Field Center (Antarctica); Defense Meteorological Satellite Program (city lights).", "Tags": ["Clouds", "Land", "Ice", "Earth", "Ocean"], "SystemTags": [], "ExternalUrls": [{ "Type": "Image", "Url": "http://www.pyxisinnovation.com/images/pipelines/ced24668-a781-4abe-b86b-a7a98c43c165.png" }] }, "Specification": { "OutputType": "Coverage", "Fields": [{ "Name": "RGB", "FieldType": "Color", "Metadata": { "Name": "RGB", "Description": "", "SystemTags": [] } }] }, "Resource": { "Id": "ced24668-a781-4abe-b86b-a7a98c43c165", "Type": "GeoSource", "Version": "365046f3-1fee-4e65-bb30-13c9902279fd" }, "Style": { "ShowAsElevation": false }, "Active": true, "ShowDetails": true }, { "Metadata": { "Comments": [], "Ratings": { "Likes": 0, "Dislikes": 0 }, "User": { "Id": "c509bb71-192b-4fa9-aa58-58ab58f43473", "Name": "Pyxis" }, "Providers": [{ "Type": "Gallery", "Id": "32f9cd5d-6ef6-4601-b367-109d8d288557", "Name": "Microsoft Bing Maps" }], "Category": "Demo", "Created": "2014-05-05T21:21:34Z", "Updated": "2015-01-11T00:09:40.058Z", "BasedOnVersion": "1d6a3b01-50ef-4d80-906c-9e1524d77c32", "Visibility": "Public", "Name": "Global Elevation (GTOPO30)", "Description": "GTOPO30 is a global digital elevation model (DEM) with a horizontal grid spacing of 30 arc seconds (approximately 1 kilometer). GTOPO30 was derived from several raster and vector sources of topographic information.\r\n\r\nGTOPO30, completed in late 1996, was developed over a three year period through a collaborative effort led by staff at the U.S. Geological Survey's Center for Earth Resources Observation and Science (EROS). The following organizations participated by contributing funding or source data:  the National Aeronautics and Space Administration (NASA), the United Nations Environment Programme/Global Resource Information Database (UNEP/GRID), the U.S. Agency for International Development (USAID), the Instituto Nacional de Estadistica Geografica e Informatica (INEGI) of Mexico, the Geographical Survey Institute (GSI) of Japan, Manaaki Whenua Landcare Research of New Zealand, and the Scientific Committee on Antarctic Research (SCAR).\r\n\r\nsource: https://lta.cr.usgs.gov/GTOPO30", "Tags": ["Global", "Elevation"], "SystemTags": [], "ExternalUrls": [{ "Type": "Image", "Url": "https://www.pyxisinnovation.com/images/pipelines/8be6a2ec-5110-49cf-a295-1008f8e9a21b.jpg" }] }, "Specification": { "OutputType": "Coverage", "Fields": [{ "Name": "RGB", "FieldType": "Number", "FieldUnit": { "Name": "m" }, "Metadata": { "Name": "Elevation", "Description": "", "SystemTags": [] } }] }, "Resource": { "Id": "8be6a2ec-5110-49cf-a295-1008f8e9a21b", "Type": "GeoSource", "Version": "0329caed-c92e-49c7-b7ce-d0b81af25d97" }, "Style": { "Fill": { "PaletteExpression": "RGB", "Style": "Palette", "Palette": { "Steps": [{ "Value": 0, "Color": "#000000" }, { "Value": 9000, "Color": "#FFFFFF" }] }, "Color": null }, "ShowAsElevation": true }, "Active": true, "ShowDetails": true, "Legend": { "Expanded": true } }] }], "Dashboards": [{ "Widgets": [] }], "EmbeddedResources": [] },
        camera: { "Tilt": 0.00005954420871034927, "Heading": 347.75218911007534, "Latitude": 36.40414238536614, "Longitude": -29.392922662412214, "Altitude": 0, "Range": 11828209.224191863 }
    });
    $scope.timeLine.push({
        duration: 5,
        start: 25,                
        map: { "Type": "Map", "Metadata": { "Name": "New Map" }, "Expanded": true, "Groups": [{ "Metadata": { "Name": "" }, "Items": [{ "Metadata": { "Comments": [], "Ratings": { "Likes": 0, "Dislikes": 0 }, "User": { "Id": "23119ff4-b1c8-47a9-9817-65deb2d02a4e", "Name": "JoJonesMaps" }, "Providers": [{ "Type": "Gallery", "Id": "5b434fa1-b578-4eb2-81c5-a823377aa931", "Name": "JoJonesMaps" }], "Category": "SDK", "Created": "2015-09-27T02:50:11.578Z", "Updated": "2015-09-27T02:50:11.578Z", "BasedOnVersion": "20571fad-20f4-4869-b5fe-ebca54cbd890", "Visibility": "Public", "Name": "Land Surface, Ocean Colour, Sea Ice, and Clouds", "Description": "This spectacular “blue marble” image is the most detailed true-color image of the entire Earth to date. Using a collection of satellite-based observations, scientists and visualizers stitched together months of observations of the land surface, oceans, sea ice, and clouds into a seamless, true-color mosaic of every square kilometer (.386 square mile) of our planet. \n\nCredit: NASA Goddard Space Flight Center Image by Reto Stöckli (land surface, shallow water, clouds). Enhancements by Robert Simmon (ocean color, compositing, 3D globes, animation). Data and technical support: MODIS Land Group; MODIS Science Data Support Team; MODIS Atmosphere Group; MODIS Ocean Group Additional data: USGS EROS Data Center (topography); USGS Terrestrial Remote Sensing Flagstaff Field Center (Antarctica); Defense Meteorological Satellite Program (city lights).", "Tags": ["Clouds", "Land", "Ice", "Earth", "Ocean"], "SystemTags": [], "ExternalUrls": [{ "Type": "Image", "Url": "http://www.pyxisinnovation.com/images/pipelines/ced24668-a781-4abe-b86b-a7a98c43c165.png" }] }, "Specification": { "OutputType": "Coverage", "Fields": [{ "Name": "RGB", "FieldType": "Color", "Metadata": { "Name": "RGB", "Description": "", "SystemTags": [] } }] }, "Resource": { "Id": "ced24668-a781-4abe-b86b-a7a98c43c165", "Type": "GeoSource", "Version": "365046f3-1fee-4e65-bb30-13c9902279fd" }, "Style": { "ShowAsElevation": false }, "Active": true, "ShowDetails": true }, { "Metadata": { "Comments": [], "Ratings": { "Likes": 0, "Dislikes": 0 }, "User": { "Id": "c509bb71-192b-4fa9-aa58-58ab58f43473", "Name": "Pyxis" }, "Providers": [{ "Type": "Gallery", "Id": "32f9cd5d-6ef6-4601-b367-109d8d288557", "Name": "Microsoft Bing Maps" }], "Category": "Demo", "Created": "2014-05-05T21:21:34Z", "Updated": "2015-01-11T00:09:40.058Z", "BasedOnVersion": "1d6a3b01-50ef-4d80-906c-9e1524d77c32", "Visibility": "Public", "Name": "Global Elevation (GTOPO30)", "Description": "GTOPO30 is a global digital elevation model (DEM) with a horizontal grid spacing of 30 arc seconds (approximately 1 kilometer). GTOPO30 was derived from several raster and vector sources of topographic information.\r\n\r\nGTOPO30, completed in late 1996, was developed over a three year period through a collaborative effort led by staff at the U.S. Geological Survey's Center for Earth Resources Observation and Science (EROS). The following organizations participated by contributing funding or source data:  the National Aeronautics and Space Administration (NASA), the United Nations Environment Programme/Global Resource Information Database (UNEP/GRID), the U.S. Agency for International Development (USAID), the Instituto Nacional de Estadistica Geografica e Informatica (INEGI) of Mexico, the Geographical Survey Institute (GSI) of Japan, Manaaki Whenua Landcare Research of New Zealand, and the Scientific Committee on Antarctic Research (SCAR).\r\n\r\nsource: https://lta.cr.usgs.gov/GTOPO30", "Tags": ["Global", "Elevation"], "SystemTags": [], "ExternalUrls": [{ "Type": "Image", "Url": "https://www.pyxisinnovation.com/images/pipelines/8be6a2ec-5110-49cf-a295-1008f8e9a21b.jpg" }] }, "Specification": { "OutputType": "Coverage", "Fields": [{ "Name": "RGB", "FieldType": "Number", "FieldUnit": { "Name": "m" }, "Metadata": { "Name": "Elevation", "Description": "", "SystemTags": [] } }] }, "Resource": { "Id": "8be6a2ec-5110-49cf-a295-1008f8e9a21b", "Type": "GeoSource", "Version": "0329caed-c92e-49c7-b7ce-d0b81af25d97" }, "Style": { "Fill": { "PaletteExpression": "RGB", "Style": "Palette", "Palette": { "Steps": [{ "Value": 0, "Color": "#000000" }, { "Value": 9000, "Color": "#FFFFFF" }] }, "Color": null }, "ShowAsElevation": true }, "Active": true, "ShowDetails": true, "Legend": { "Expanded": true } }] }], "Dashboards": [{ "Widgets": [] }], "EmbeddedResources": [] },
        camera: { "Tilt": 0.00006820043071797954, "Heading": 335.7346951090322, "Latitude": 36.633369183827064, "Longitude": -5.760856598212501, "Altitude": 0, "Range": 1033244.0324160167 }
    });

    $scope.sections = [
        {
            duration: 10,
            start: 0,
            name: "Metallic",
            color: "#888"
        },
        {
            duration: 10,
            start: 10,
            name: "Purple",
            color: "#808"
        },
        {
            duration: 10,
            start: 20,
            name: "Clouds",
            color: "#383",
        }
    ]

    $scope.state = {
        currentTime: 0,
        activeStep: undefined,
        startClockTime: new Date().getTime(),
        endTime: 30,        
        loop: true,
        play: true
    }

    function startAnimation() {
        $interval(function () {
            if ($scope.state.play) {
                $scope.state.currentTime = (new Date().getTime() - $scope.state.startClockTime) / 1000.0;
                if ($scope.state.currentTime > $scope.state.endTime) {
                    $scope.state.startClockTime = new Date().getTime();
                    $scope.state.currentTime = 0;
                }
            }

            var activeStep = undefined;
            angular.forEach($scope.timeLine, function (step) {
                if (step.start <= $scope.state.currentTime) {
                    activeStep = step;
                }
            });

            if (activeStep !== $scope.state.activeStep) {
                $scope.state.activeStep = activeStep;
                $scope.setCurrentMap($scope.state.activeStep.map);
                $pyx.globe.setCamera($scope.state.activeStep.camera, $scope.state.activeStep.duration * 0.9 * 1000);
            }

        }, 15);
    }

   

    $scope.$on("pyx-globe-click", function () {
        $scope.state.play = false;
        $pyx.globe.setCamera($pyx.globe.getCamera());
    });

    $scope.onTimeLineClick = function (time) {
        $scope.state.currentTime = time;
        $scope.state.startClockTime = (new Date().getTime()) - $scope.state.currentTime * 1000;
    }

    $scope.$on("pyx-globe-ready", function () {
        //featureWalkThrough.register($scope);
        //demoLoop.register($scope);
        startAnimation();
    });   
});

