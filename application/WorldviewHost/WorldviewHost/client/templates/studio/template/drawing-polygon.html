<div class="draw-surface">
    <div style="position: absolute; top: 0px; left: 0; right: 0; bottom: 0; overflow: hidden;" 
         ng-mouseup="addPoint($event)" right-click="cancelPaint()" ng-mousemove="modifyLastPoint($event)"
         ng-enter="closePolygon()" ng-esc="cancelPaint()">
        <svg width="100%" height="100%">
            <polygon ng-if="points.length>2" ng-attr-points="{{getPoints()}}" />
            <polyline ng-if="points.length>2" ng-attr-points="{{getPoints()}}" />
            <line ng-if="points.length>1"
                ng-attr-x1="{{points[0][0]}}" ng-attr-y1="{{points[0][1]}}"
                ng-attr-x2="{{points[points.length-1][0]}}" ng-attr-y2="{{points[points.length-1][1]}}"
                class="last-line">
            </line>
            <circle ng-if="points.length>1" ng-attr-cx="{{points[points.length-1][0]}}" ng-attr-cy="{{points[points.length-1][1]}}" r="5" class="current-vertex"></circle>
            <circle ng-if="points.length>1" ng-attr-cx="{{points[0][0]}}" ng-attr-cy="{{points[0][1]}}" r="5" class="current-vertex"></circle>
            <circle ng-if="points.length>1" ng-attr-cx="{{points[0][0]}}" ng-attr-cy="{{points[0][1]}}" r="10" class="vertex" 
                    stop-propagation="mouseup" ng-mouseenter="snapLastPoint(true)" ng-mouseleave="snapLastPoint(false)" ng-mouseup="closePolygon()"></circle>
        </svg>
    </div>
</div>